---
/**
 * Calendar Widget
 * Displays mini calendar with today's events
 */
interface Props {
  title?: string;
  class?: string;
}

const { title = 'ä»Šæ—¥æ—¥ç¨‹', class: className } = Astro.props;

// Get current date info
const now = new Date();
const currentMonth = now.toLocaleDateString('zh-CN', { month: 'long' });
const currentDay = now.getDate();
const currentWeekday = now.toLocaleDateString('zh-CN', { weekday: 'long' });

// Mock events data
const todayEvents = [
  {
    id: '1',
    title: 'å›¢é˜Ÿç«™ä¼š',
    time: '09:00',
    duration: '30åˆ†é’Ÿ',
    type: 'meeting',
  },
  {
    id: '2',
    title: 'äº§å“è¯„å®¡',
    time: '14:00',
    duration: '1å°æ—¶',
    type: 'meeting',
  },
  {
    id: '3',
    title: 'é¡¹ç›®æˆªæ­¢æ—¥æœŸ',
    time: '18:00',
    duration: '',
    type: 'deadline',
  },
];

const eventTypeColors = {
  meeting: 'bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300',
  deadline: 'bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300',
  reminder: 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300',
};

const eventTypeIcons = {
  meeting: 'ğŸ‘¥',
  deadline: 'â°',
  reminder: 'ğŸ“Œ',
};
---

<div class:list={['card p-6', className]}>
  <div class="flex items-center justify-between mb-4">
    <h3 class="text-lg font-semibold text-gray-900 dark:text-white">
      {title}
    </h3>
    <a
      href="/dashboard/calendar"
      class="text-sm text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300"
    >
      æŸ¥çœ‹æ—¥å†
    </a>
  </div>

  <!-- Current Date Display -->
  <div
    class="mb-4 p-4 bg-gradient-to-br from-primary-50 to-primary-100 dark:from-primary-900/20 dark:to-primary-800/20 rounded-lg"
  >
    <div class="flex items-center justify-between">
      <div>
        <p class="text-sm text-gray-600 dark:text-gray-400">{currentMonth}</p>
        <p class="text-3xl font-bold text-gray-900 dark:text-white">
          {currentDay}
        </p>
        <p class="text-sm text-gray-600 dark:text-gray-400">
          {currentWeekday}
        </p>
      </div>
      <div class="text-5xl opacity-20">ğŸ“…</div>
    </div>
  </div>

  <!-- Today's Events -->
  <div class="space-y-3">
    {
      todayEvents.length > 0 ? (
        todayEvents.map((event) => (
          <div class="flex items-start gap-3 p-3 rounded-lg border border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors">
            <div class="flex-shrink-0 text-2xl">
              {eventTypeIcons[event.type as keyof typeof eventTypeIcons]}
            </div>
            <div class="flex-1 min-w-0">
              <p class="text-sm font-medium text-gray-900 dark:text-white">{event.title}</p>
              <div class="flex items-center gap-2 mt-1">
                <span class="text-xs text-gray-500 dark:text-gray-400">{event.time}</span>
                {event.duration && (
                  <>
                    <span class="text-xs text-gray-400">â€¢</span>
                    <span class="text-xs text-gray-500 dark:text-gray-400">{event.duration}</span>
                  </>
                )}
              </div>
            </div>
            <span
              class:list={[
                'px-2 py-1 text-xs font-medium rounded',
                eventTypeColors[event.type as keyof typeof eventTypeColors],
              ]}
            >
              {event.type === 'meeting' && 'ä¼šè®®'}
              {event.type === 'deadline' && 'æˆªæ­¢'}
              {event.type === 'reminder' && 'æé†’'}
            </span>
          </div>
        ))
      ) : (
        <div class="text-center py-8">
          <div class="text-4xl mb-2">ğŸ‰</div>
          <p class="text-sm text-gray-500 dark:text-gray-400">ä»Šå¤©æ²¡æœ‰å®‰æ’çš„æ—¥ç¨‹</p>
        </div>
      )
    }
  </div>

  <!-- Quick Actions -->
  <div class="mt-4 pt-4 border-t border-gray-200 dark:border-gray-700">
    <button class="w-full btn btn-primary text-sm py-2 flex items-center justify-center gap-2">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="16"
        height="16"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
      >
        <line x1="12" y1="5" x2="12" y2="19"></line>
        <line x1="5" y1="12" x2="19" y2="12"></line>
      </svg>
      æ·»åŠ æ—¥ç¨‹
    </button>
  </div>
</div>
