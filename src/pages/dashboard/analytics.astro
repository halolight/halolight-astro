---
/**
 * åˆ†æé¡µé¢ - ä½¿ç”¨æ–°çš„ä»ªè¡¨ç›˜å°éƒ¨ä»¶
 */
import DashboardLayout from '../../layouts/DashboardLayout.astro';
import ChartBarWidget from '../../components/dashboard/widgets/ChartBarWidget.astro';
import ChartPieWidget from '../../components/dashboard/widgets/ChartPieWidget.astro';
import RecentUsersWidget from '../../components/dashboard/widgets/RecentUsersWidget.astro';
import TasksWidget from '../../components/dashboard/widgets/TasksWidget.astro';
import CalendarWidget from '../../components/dashboard/widgets/CalendarWidget.astro';

// åˆ†ææ•°æ®
const metrics = [
  { label: 'é¡µé¢æµè§ˆé‡', value: '45,678', change: '+15%', period: 'è¾ƒä¸Šå‘¨' },
  { label: 'ç‹¬ç«‹è®¿å®¢', value: '12,345', change: '+8%', period: 'è¾ƒä¸Šå‘¨' },
  { label: 'å¹³å‡ä¼šè¯æ—¶é•¿', value: '4:32', change: '+12%', period: 'è¾ƒä¸Šå‘¨' },
  { label: 'è·³å‡ºç‡', value: '32%', change: '-5%', period: 'è¾ƒä¸Šå‘¨' },
];

const topPages = [
  { path: '/dashboard', views: 8234, percentage: 28 },
  { path: '/dashboard/users', views: 5621, percentage: 19 },
  { path: '/dashboard/analytics', views: 4532, percentage: 15 },
  { path: '/dashboard/documents', views: 3421, percentage: 12 },
  { path: '/dashboard/settings', views: 2876, percentage: 10 },
];

const topCountries = [
  { name: 'ä¸­å›½', users: 8234, flag: 'ğŸ‡¨ğŸ‡³' },
  { name: 'ç¾å›½', users: 2341, flag: 'ğŸ‡ºğŸ‡¸' },
  { name: 'æ—¥æœ¬', users: 1234, flag: 'ğŸ‡¯ğŸ‡µ' },
  { name: 'éŸ©å›½', users: 987, flag: 'ğŸ‡°ğŸ‡·' },
  { name: 'æ–°åŠ å¡', users: 543, flag: 'ğŸ‡¸ğŸ‡¬' },
];
---

<DashboardLayout title="åˆ†æ">
  <div class="space-y-6">
    <!-- é¡µé¢æ ‡é¢˜ -->
    <div class="flex items-center justify-between">
      <div>
        <h2 class="text-2xl font-bold text-gray-900 dark:text-white">æ•°æ®åˆ†æ</h2>
        <p class="mt-1 text-gray-600 dark:text-gray-400">æŸ¥çœ‹ç½‘ç«™æµé‡å’Œç”¨æˆ·è¡Œä¸ºåˆ†æ</p>
      </div>
      <div class="flex gap-2">
        <select class="input py-2 px-3 w-auto">
          <option>æœ€è¿‘ 7 å¤©</option>
          <option>æœ€è¿‘ 30 å¤©</option>
          <option>æœ€è¿‘ 90 å¤©</option>
          <option>ä»Šå¹´</option>
        </select>
        <button class="btn-primary">å¯¼å‡ºæ•°æ®</button>
      </div>
    </div>

    <!-- æŒ‡æ ‡å¡ç‰‡ -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
      {
        metrics.map((metric) => (
          <div class="card p-6">
            <p class="text-sm text-gray-600 dark:text-gray-400">{metric.label}</p>
            <p class="mt-2 text-3xl font-bold text-gray-900 dark:text-white">{metric.value}</p>
            <p class="mt-2 text-sm">
              <span
                class={
                  metric.change.startsWith('+')
                    ? 'text-green-600 dark:text-green-400'
                    : 'text-red-600 dark:text-red-400'
                }
              >
                {metric.change}
              </span>
              <span class="text-gray-500 dark:text-gray-500"> {metric.period}</span>
            </p>
          </div>
        ))
      }
    </div>

    <!-- å›¾è¡¨å°éƒ¨ä»¶åŒºåŸŸ -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
      <!-- æŸ±çŠ¶å›¾å°éƒ¨ä»¶ - é”€å”®ç»Ÿè®¡ -->
      <ChartBarWidget title="æœˆåº¦é”€å”®ç»Ÿè®¡" />

      <!-- é¥¼å›¾å°éƒ¨ä»¶ - è®¾å¤‡åˆ†å¸ƒ -->
      <ChartPieWidget title="è®¾å¤‡åˆ†å¸ƒ" />
    </div>

    <!-- æ•°æ®è¡¨æ ¼ -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
      <!-- çƒ­é—¨é¡µé¢ -->
      <div class="card p-6">
        <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">çƒ­é—¨é¡µé¢</h3>
        <div class="space-y-4">
          {
            topPages.map((page) => (
              <div class="flex items-center gap-4">
                <div class="flex-1 min-w-0">
                  <p class="text-sm font-medium text-gray-900 dark:text-white truncate">
                    {page.path}
                  </p>
                  <div class="mt-1 w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
                    <div
                      class="bg-primary-600 h-2 rounded-full"
                      style={`width: ${page.percentage}%`}
                    />
                  </div>
                </div>
                <div class="text-right">
                  <p class="text-sm font-medium text-gray-900 dark:text-white">
                    {page.views.toLocaleString()}
                  </p>
                  <p class="text-xs text-gray-500 dark:text-gray-400">{page.percentage}%</p>
                </div>
              </div>
            ))
          }
        </div>
      </div>

      <!-- ç”¨æˆ·åœ°åŒºåˆ†å¸ƒ -->
      <div class="card p-6">
        <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">ç”¨æˆ·åœ°åŒºåˆ†å¸ƒ</h3>
        <div class="space-y-4">
          {
            topCountries.map((country) => (
              <div class="flex items-center gap-4">
                <span class="text-2xl">{country.flag}</span>
                <div class="flex-1">
                  <p class="text-sm font-medium text-gray-900 dark:text-white">{country.name}</p>
                </div>
                <p class="text-sm font-medium text-gray-900 dark:text-white">
                  {country.users.toLocaleString()} ç”¨æˆ·
                </p>
              </div>
            ))
          }
        </div>
      </div>
    </div>

    <!-- æ‰©å±•å°éƒ¨ä»¶åŒºåŸŸ - æ˜¾ç¤ºæœ€è¿‘ç”¨æˆ·ã€å¾…åŠä»»åŠ¡å’Œæ—¥ç¨‹ -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
      <!-- æœ€è¿‘ç”¨æˆ·å°éƒ¨ä»¶ -->
      <RecentUsersWidget />

      <!-- å¾…åŠä»»åŠ¡å°éƒ¨ä»¶ -->
      <TasksWidget />

      <!-- æ—¥å†å°éƒ¨ä»¶ -->
      <CalendarWidget />
    </div>
  </div>
</DashboardLayout>
